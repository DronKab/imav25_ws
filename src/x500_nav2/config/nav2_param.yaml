amcl:
  ros__parameters:
    use_sim_time: true
    alpha1: 0.2
    alpha2: 0.2
    alpha3: 0.2
    alpha4: 0.2
    base_frame_id: "base_link"   # ‚Üê ya que as√≠ aparece en tu TF
    odom_frame_id: "odom"
    scan_topic: "/scan"
    map_topic: "/map"
    min_particles: 500
    max_particles: 2000
    set_initial_pose: true
    always_reset_initial_pose: false
    global_frame_id: "map"       # ‚Üê este es el frame que Nav2 usar√°

map_server:
  ros__parameters:
    use_sim_time: true
    yaml_filename: "$(find-pkg-share x500_nav2)/maps/mapa.yaml"

planner_server:
  ros__parameters:
    use_sim_time: true
    planner_plugins: ["GridBased"]
    GridBased:
      plugin: "nav2_navfn_planner/NavfnPlanner"
      tolerance: 0.5
      use_astar: false

controller_server:
  ros__parameters:
    use_sim_time: true
    controller_plugins: ["FollowPath"]
    current_goal_checker: "goal_checker"

    FollowPath:
      plugin: "nav2_regulated_pure_pursuit_controller::RegulatedPurePursuitController"
      cmd_vel_topic: "/px4_driver/cmd_vel"      # üëà mover aqu√≠
      desired_linear_vel: 0.5
      lookahead_dist: 0.6
      min_lookahead_dist: 0.3
      max_lookahead_dist: 0.9
      lookahead_time: 1.5
      rotate_to_heading_angular_vel: 1.8
      transform_tolerance: 0.1
      use_velocity_scaled_lookahead_dist: true

    goal_checker:
      plugin: "nav2_controller::SimpleGoalChecker"
      xy_goal_tolerance: 0.3
      yaw_goal_tolerance: 0.1

bt_navigator:
  ros__parameters:
    use_sim_time: true
    default_bt_xml_filename: "navigate_w_replanning_and_recovery.xml"

behavior_server:
  ros__parameters:
    use_sim_time: true

waypoint_follower:
  ros__parameters:
    use_sim_time: true
    plugin_lib_names: ["wait_at_waypoint"]

lifecycle_manager:
  ros__parameters:
    use_sim_time: true
    autostart: true
    node_names: ['map_server', 'amcl', 'planner_server', 'controller_server', 'bt_navigator']
